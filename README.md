# ComfyUI_metadata_extractor
extract metadata from .png images generated by ComfyUI

# Python Image Metadata Processing Script

## Overview
This script processes multiple `.png` files to extract and clean specific metadata patterns. The results, along with the file names, are saved to a `results.txt` file. The script also provides a summary of how many files were processed.

## Functions

### `read_metadata(file_path)`
- **Purpose**: Reads and extracts metadata from a given image file.
- **Parameters**:
  - `file_path` (str): The path to the image file.
- **Returns**: A dictionary containing the metadata of the image. If an error occurs, it returns an error message string.
- **Exceptions**: Catches exceptions related to file reading and image processing.

### `extract_pattern_from_metadata(metadata, pattern)`
- **Purpose**: Extracts a specific pattern from the metadata.
- **Parameters**:
  - `metadata` (dict): The metadata of the image.
  - `pattern` (str): The regular expression pattern to search for in the metadata.
- **Returns**: A string of the matched pattern. If no pattern is found, returns a 'Pattern not found in metadata.' message.

### `clean_extracted_string(extracted_string)`
- **Purpose**: Cleans the extracted string from the metadata.
- **Parameters**:
  - `extracted_string` (str): The string extracted from the metadata.
- **Returns**: A cleaned and formatted version of the extracted string.

### `save_to_file(content, file_name)`
- **Purpose**: Appends the given content to a specified text file.
- **Parameters**:
  - `content` (str): The content to write to the file.
  - `file_name` (str): The name of the file to which the content will be appended.
- **Returns**: A success message indicating content has been appended, or an error message in case of failure.

### `process_files(file_paths)`
- **Purpose**: Processes each file in the provided list of file paths.
- **Parameters**:
  - `file_paths` (list): A list of file paths to be processed.
- **Behavior**: Iterates over each file path, processes the file, and appends the result to a common `results.txt` file. Keeps track of the number of processed files and appends this information at the end.

### `main()`
- **Purpose**: Main function to execute the script.
- **Behavior**: Checks for the presence of file paths passed as command-line arguments. Calls `process_files` with the list of file paths.

## Usage
Run the script from the command line, passing the paths of `.png` files as arguments. For example:
```bash
python script.py image1.png image2.png
```

The script will process each image, extract and clean metadata, and save the results to `results.txt`.

## Output

- The script outputs the results of the processed files to `results.txt`, each entry containing the file name and the extracted metadata.
- A summary line at the end of `results.txt` indicates the total number of files processed.

